
;; FUNCTIONS

;; Add MELPA to package source list
(defun add-melpa-to-package-list ()
  "Adds melpa to package source list"
  (require 'package)
  (let* ((no-ssl (and (memq system-type '(windows-nt ms-dos))
                      (not (gnutls-available-p))))
	 (proto (if no-ssl "http" "https")))
    ;; Comment/uncomment these two lines to enable/disable MELPA and MELPA Stable as desired
    (add-to-list 'package-archives (cons "melpa" (concat proto "://melpa.org/packages/")) t)
    ;;(add-to-list 'package-archives (cons "melpa-stable" (concat proto "://stable.melpa.org/packages/")) t)
    (when (< emacs-major-version 24)
      ;; For important compatibility libraries like cl-lib
      (add-to-list 'package-archives '("gnu" . (concat proto "://elpa.gnu.org/packages/")))))
  )

(defun add-erlang-support ()
  "Enables erlang support by adding sources to load-path variable"
  (setq load-path (cons "/usr/lib/erlang/lib/tools-3.0/emacs/" load-path))

  (setq erlang-root-dir "/usr/lib/erlang")
  (setq exec-path (cons "/usr/lib/erlang/bin" exec-path))
  (require 'erlang-start)
  )

;; CONFIGURATION

;; Enable package support
(add-melpa-to-package-list)
(package-initialize)

;; Enable erlang support
(if
    (eq 0 (length (shell-command-to-string "command -v erl")))
    (warn "Enable erlang support: no erl found")
  (add-erlang-support)  
  )

;; Enable auto completion
(require 'auto-complete)
(ac-config-default)

;; Enable moving with shift through buffers
(require 'windmove)
(windmove-default-keybindings)

;; No more M-x "query-replace-regexp"
(substitute-key-definition 'delete-indentation
			   'query-replace-regexp
			   (current-global-map))

;; Eval-region for M-:
(substitute-key-definition 'eval-expression
                           'eval-region
                           (current-global-map))
